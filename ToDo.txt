# TODO:
#    [v] Guess more aspect ratios:
#			nope: Guessing is impossible..
#    [v] Use gauss blur for composite color bleeding?
#    	    Tried, does not produce great visible improvements
#    [v] Vignette and spot could be done earlier at lower res?
#        Made a bit lighter version right in final_pass instead.
#    [v] reference new repo from the main one
#    [v] Noise is not visible on black or white, much more on gray, why?
#        Probably a matter of post processing
#    [v] Try to get rid of mark_unneeded() in reflection_blur_y
#        didit and it is useless, no measurable perf increase.
#    [v] Why tv presets have +5% brightness?
#        Because the contrast is pushed too.
#    [v] First bloom pass: why don't we use an higher lod?
#        Using an higher lod makes the bloom less prone to detect thinner lines
#        So, no.
#    [v] Does bloom quality improve if we sample from original?
#        yeah!
#    [v] #pragmas to vertex shader to fragment shader
#        Why and when performances start to degrade?
#        ...It seems it happen when too many UBOs or Push constants are readed
#           by the Vertex shader and passed to the fragment one.
#           (not tested if the pass from fragment to vertex is needed to reproduce the issue)
#    [v] What if i do vmask and darklines (scanlines too in alpha??)
#        in a little pass that scales to absolute size?
#        or even a lut with the mask...
#        No gain, texture lookups are heavier than expected.
#    [v] textureSize() appears to be quite heavy, consider to make bezel coords fixed.
#        Done, expected to gain more, if something.
#        You just use it to calc lods, is it worth?
#    [v] Reflection blur size, make id not dependand on input resolution.
#    [v] When colorizing bezel with ambilight, apply noise over it as well
#    [v] Blur less near the start of the bezel
#    [v] Make the reflection blur shade point configurable
#    [v] Rotate image: auto (-1)... Does it work?
#        yes.
#    [v] Put blank lines after #pragma parameter groups
#    [v] Bloom: would it make sense to gather the average luminosity in a wide
#        zone around the current pixel instead of the whole scene?
#        Yes, it works good.
#    [v] should min_w in avglum_pass depend on content resolution?
#        lod = log2(params.SourceSize.y / min_w); in avglum_pass is wrong (w/y?)
#        Both fixed by specifying the lod instead of doing stupid calculations.mip_lod
#        So fixed, and achieved what was needed.
#    [v] When using dynamic zoom, bezel reflection should be dynamically adapted
#        ...this is tough, zomoing reflection wouldn't work.
#    [v] Further tune reflection shade
#    [v] Do a debug image with a white object on black backgroud to tune bloom exposure over time
#    [v] Unbranch phase shift in ntsc pass, trivial
#    [v] Negative gap brightness produces glitches on bezel (nvidia specific?)
#        yes, due to negative pow base.         
#    [v] Unrolled blur in relfections is not gaussiany(gaussianx), was that a mistake?
#        No mistake, they look best that way since we need big blurs.
#    [v] When colorizing the bezel via ambilight, a small area between the tube and the
#        bezel border is colored and should not.
#    [.] Darkline, vmask: whiteness can be pre-calculated outside.
#        Half done, gained something.
#    [v] reflection blur: can we make better use of mipmaps instead of blindly use lod = 2.0?
#    [v] avglum_pass needs to react to content aspect override
#    [v] Bezel colorization via ambilight acts strangely when the content aspect is shrinked
#          [v] It also bleeds over alpha channel in the internal frame.
#          [v] disabled by now till we find a better way to handle it.
#               This: https://github.com/kokoko3k/koko-aio-slang/commit/1fbbee4f73948cd85e0d53db3a2d4eaab8951a8f is a reference commit
#               where i switched from a try to a second one.
#          [v] maybe it can be modulated from the outside via min(coord.x,coord.y)
#    [v] Ambient light skip coords should be aware of the h/v shift override or black box whould appear
#        Not a big deal, since it happens when moving the image far, far away.
#    [..] specular reflections does not 100% follow the image when overriding aspect
#        It is hard and probably would require another pass for somethig nobody would ever notice.
#        ...also, avglum_pass is used by bloom pass too.
#    [ ] check branching conditions in first_pass.slang
#    [ ] Better debanding?
#    [ ] Should the flickering be aware of the scanline?
#        read: does a scanline dark gap increment the flickering or not?
#    [ ] deconvergence after glow/halo?
#    [ ] Glow spread in final pass?
#    [ ] Find a way to smooth borders without cropping the image
#    [ ] Allow to configure new bezel parameters?
#        Reflection strength, corner shape, size and fade?  

#    [ ] bloom should bleed over when forcing geometry aspect
#    [ ] reflection blurriness should not depend on input resolution
#    [ ] copy base presets to overlay repo (after release)
#    [ ] ambilight leds falloff should use a gamma function/pow
#    [ ] mirror bg_under image so that reflective parts points to the center.
#    [ ] Sembra strano, controlla se esatto in finalpass:
#        float ambi_colorize_shade =  1 - fuzzyrect(coords_for_bezel, size,  radius,  blur) * 2;
